<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>コース管理</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@300&family=Noto+Sans+JP:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/teacherManage.css">
</head>
<body>
    <el-container id="app" class="manage">
        <header class="common-header">
            <div class="caption">
                ひかりITスクール
            </div>
            <div>
                管理者
            </div>
        </header>
        <el-aside width="200px" class="side-menu">
            <el-menu default-active="2" class="el-menu-vertical-demo">
                <el-menu-item index="1" @click="goCourseManage">コース管理</el-menu-item>
                <el-menu-item index="2">教員管理</el-menu-item>
                <el-menu-item index="3">学生管理</el-menu-item>
            </el-menu>
        </el-aside>
        <!-- <el-container class="side-menu-container">
            
        </el-container> -->

        <el-container class="comm-main teacher-manage" v-cloak>
            <el-main>
                <div class="search-container">
                    <div class="search-item">
                        <label>教員氏名</label>
                        <el-select 
                            v-model="searchTeacherId" 
                            class="search-input"
                            clearable
                        >
                            <el-option
                              v-for="item in teacher"
                              :key="item.value"
                              :label="item.label"
                              :value="item.value">
                            </el-option>
                        </el-select>
                        <el-button 
                            type="primary"
                            @click="loadData"
                            class="search-btn"
                        >
                            検索
                        </el-button>
                    </div>
                    
                </div>
                <div class="teacher-list-container">
                    <ul v-for="tItem in teacher">
                        <li>{{tItem.teacherName}} 先生</li>
                        <div>担任している授業：</div>
                        <ul v-for="c in tItem.courses">
                            <li>{{c.className}}</li>
                        </ul>
                    </ul>
                </div>
            </el-main>
        </el-container>
    </el-container>
</body>
</html>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://unpkg.com/element-ui/lib/umd/locale/ja.js"></script>
<script src="../js/utils.js"></script>
<script>
    ELEMENT.locale(ELEMENT.lang.ja);
    let vm;
    vm = new Vue({
        el: "#app",
        data() {
            return {
                // courses: [],
                // category: [],
                teacher: [],
                // data: [],
                searchInfo: {},
                searchTeacherId: undefined,
            };
        },
        mounted(){
            this.loginCheck();
            this.loadTeacher();
            this.loadTeacherOfCourses();
        },
        methods: {
            loginCheck() {
                if (!isLogin()) return;
            },
            loadTeacher() {
                let self = this;
                return new Promise((resolve, reject) => {
                    axios({
                        method: "GET",
                        url: "/course/teacher/getAll",
                        
                    })
                        .then((res = {}) => {
                            const { data: { data: teacher = [] } = {} } = res;
                            self.teacher = teacher;
                            self.teacher = teacher.map(item => {
                                const {teacherId, teacherName} = item;
                                return {
                                    value: teacherId,
                                    label: teacherName,
                                    ...item
                                };
                            });
                            resolve();
                        })
                });
            },
            loadTeacherOfCourses() {
                axios({
                        method: "GET",
                        url: "/course/teacher/getCourses"
                    })
                        .then((res = {}) => {
                            const {
                                data: {
                                    data = []
                                } = {},
                            } = res;
                            this.teacher = data;
                        });

            },
            goCourseManage() {
                location.href = "/html/classesManage.html";
            }
        }
    });
</script>
